(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"4xTf":function(e,t,a){e.exports={TableWarp:"antd-pro-websrc-src-pages-management-category-list-TableWarp",Drawer_Footer:"antd-pro-websrc-src-pages-management-category-list-Drawer_Footer",formTree:"antd-pro-websrc-src-pages-management-category-list-formTree"}},iyAM:function(e,t,a){e.exports={menuTableRight:"antd-pro-websrc-src-pages-management-category-style-menuTableRight",TreeMenuLeft:"antd-pro-websrc-src-pages-management-category-style-TreeMenuLeft",TreeMenuButton:"antd-pro-websrc-src-pages-management-category-style-TreeMenuButton",icon_heading:"antd-pro-websrc-src-pages-management-category-style-icon_heading"}},lqAA:function(e,t,a){"use strict";a.r(t);a("14J3");var n,r,l,i,o,s,d,c,u=a("BMrR"),m=(a("T2oS"),a("W9HT")),p=(a("jCWc"),a("kPKH")),g=(a("Pwec"),a("CtXQ")),y=(a("7Kak"),a("9yH6")),f=a("p0pE"),h=a.n(f),b=(a("2qtc"),a("kLXV")),v=a("jehZ"),E=a.n(v),k=(a("+L6B"),a("2/Rp")),C=(a("Mwp2"),a("VXEj")),T=a("2Taf"),M=a.n(T),w=a("vZ4D"),S=a.n(w),O=a("l4Ni"),I=a.n(O),A=a("ujKo"),U=a.n(A),R=a("MhPg"),V=a.n(R),z=(a("y8nQ"),a("Vl3Y")),D=(a("5NDa"),a("5rEg")),x=(a("ozfa"),a("MJZm")),L=a("q1tI"),N=a.n(L),_=a("MuoO"),B=(a("g9YV"),a("wCAj")),j=(a("DjyN"),a("NUBc")),P=a("eHn4"),F=a.n(P),q=(a("OaEy"),a("2fM7")),Y=(a("tU7J"),a("wFql")),H=a("+n12"),K=a("4xTf"),G=a.n(K),W=(a("wd/R"),Y["a"].Text),X=(x["a"].TreeNode,q["a"].Option,D["a"].Search),J=(D["a"].TextArea,n=z["a"].create(),r=Object(_["connect"])(function(e){var t=e.global,a=e.loading;return{global:t,loading:a.models.global}}),n(l=r((i=function(e){function t(){var e,a;M()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=I()(this,(e=U()(t)).call.apply(e,[this].concat(r))),a.state={start:1,visible:!1,selectedRowKeys:[],selectedRows:[],startValue:null,endValue:null,endOpen:!1},a.getList=function(e){var t=a.props,n=t.dispatch,r=t.type,l=t.fatherBigListItem,i=t.smallPaginationParams;e.id=i.id||l.id,console.log(e),n({type:r,payload:e})},a.onChange=function(e){var t=a.props,n=t.fatherBigListItem,r=t.smallPaginationParams;a.setState({start:e},function(){var t=a.state,l=(t.start,t.name),i=h()({},a.state.filter,{start:(e-1)*H["j"],id:r.id||n.id,count:H["j"],name:l});a.getList(i)})},a.handleClickReset=function(){var e=a.props.form.resetFields;a.setState({start:1},function(){var t=a.state.start;a.setState({filter:{},name:void 0});var n={start:(t-1)*H["j"],count:H["j"]};e(),a.getList(n)})},a.handleFooterSubmit=function(e){var t=a.props,n=t.form.validateFields;t.type;n(function(t,n){a.setState({name:e,start:1});var r={name:e,start:0,count:H["j"]};a.getList(r)})},a.onClickDelConfirmModel=function(e){var t=b["a"].confirm();t.update({title:"\u5220\u9664\u63d0\u793a",okText:"\u786e\u5b9a",cancelText:"\u8fd4\u56de",centered:!0,content:N.a.createElement(W,null," \u662f\u5426\u786e\u5b9a\u8981\u5220\u9664"),onCancel:function(){t.destroy()},onOk:function(){a.handleClickDel(),t.destroy()}})},a.handleClickDel=function(){var e=a.props,t=e.dispatch,n=(e.type,e.delButton),r=e.fatherBigListItem,l=a.state.selectedRows.map(function(e){return e.id});t({type:n,payload:{ids:l.join(","),id:r&&r.id},callback:function(){a.setState({selectedRowKeys:[],start:1})}})},a.disabledStartDate=function(e){var t=a.state.endValue;return!(!e||!t)&&e.valueOf()>t.valueOf()},a.disabledEndDate=function(e){var t=a.state.startValue;return!(!e||!t)&&e.valueOf()<=t.valueOf()},a.onDatePickerChange=function(e,t){a.setState(F()({},e,t))},a.onStartChange=function(e){a.onDatePickerChange("startValue",e)},a.onEndChange=function(e){a.onDatePickerChange("endValue",e)},a.handleStartOpenChange=function(e){e||a.setState({endOpen:!0})},a.handleEndOpenChange=function(e){a.setState({endOpen:e})},a}return V()(t,e),S()(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e=this,t=this.props,a=t.dataSource,n=t.columns,r=(t.filter,t.fatherBigListItem),l=t.loading,i=this.state,o=(i.visible,i.selectedRowKeys),s=i.start,d={onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},selectedRowKeys:o},c=a&&a.totalCount,p=o.length>0;return N.a.createElement(L["Fragment"],null,N.a.createElement(m["a"],{spinning:l},N.a.createElement(B["a"],{className:G.a.TableWarp,dataSource:a&&a.value,rowSelection:d,columns:n,rowKey:function(e){return e.id},pagination:{position:"none"},footer:function(){return N.a.createElement(u["a"],{type:"flex",justify:"space-between"},N.a.createElement(u["a"],{type:"flex"},N.a.createElement(k["a"],{type:"primary",onClick:e.onClickDelConfirmModel,disabled:!p,style:{marginLeft:7,marginRight:15}},"\u5220\u9664"),N.a.createElement(X,{placeholder:"\u8bf7\u8f93\u5165\u67e5\u8be2\u540d\u79f0",value:e.state.name,onChange:function(t){return e.setState({name:t.target.value})},onSearch:function(t){e.handleFooterSubmit(t)},style:{width:200}}),N.a.createElement("div",{style:{marginTop:5}},r&&r.id?N.a.createElement(W,{onClick:e.handleClickReset,style:{marginLeft:10,fontSize:16,cursor:"pointer"}},"\u91cd\u7f6e"):N.a.createElement(W,{style:{marginLeft:10,fontSize:16,cursor:"pointer"},disabled:!0},"\u91cd\u7f6e"))),N.a.createElement(j["a"],{onChange:e.onChange,total:c,pageSize:H["j"],current:s}))}})))}}]),t}(L["PureComponent"]),l=i))||l)||l),Z=J,Q=a("iyAM"),$=a.n(Q),ee=a("wbS+"),te=a("xNuS"),ae=x["a"].TreeNode,ne=D["a"].TextArea,re=[{title:"\u6dfb\u52a0\u5c0f\u7c7b",type:"ADD"},{title:"\u4fee\u6539\u5927\u7c7b",type:"UPD"},{title:"\u5220\u9664\u5927\u7c7b",type:"DEL"}],le={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},ie=(o=z["a"].create(),s=Object(_["connect"])(function(e){var t=e.category,a=e.global,n=e.loading;return{category:t,global:a,cateLoading:n.models.category}}),o(d=s((c=function(e){function t(){var e,a;M()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=I()(this,(e=U()(t)).call.apply(e,[this].concat(r))),a.state={page:{X:0,Y:0},node:null,customizeMenusVisible:!1,customizeMenusAddOrUpdModalVisible:!1,customizeMenusAddOrUpd:!0,smallId:null,timeType:"\u5929",workType:"ORDINARY"},a.renderTreeNodes=function(e){return e&&e.map(function(e){return N.a.createElement(ae,{value:e.id,key:e.id,dataRef:e,title:e.name,icon:N.a.createElement("span",{className:$.a.icon_heading}),style:{marginLeft:-10,width:"92%",fontSize:16}})})},a.customizeMenus=function(){var e=a.state,t=e.page,n=t.X,r=t.Y,l=(e.customizeMenusAddOrUpd,e.node),i=a.props.dispatch;return N.a.createElement(C["a"],{itemLayout:"horizontal",dataSource:re,style:{textAlign:"center",border:"1px solid #cdcd",backgroundColor:"#fff",position:"fixed",width:80,left:"".concat(n,"px"),top:"".concat(r,"px"),zIndex:5},renderItem:function(e){return N.a.createElement(C["a"].Item,null,N.a.createElement(C["a"].Item.Meta,{title:e.title,onClick:function(){switch(a.setState({customizeMenusVisible:!1}),e.type){case"ADD":a.setState({smallAddOrUpd:!0,smallAddOrUpdModalVisible:!0});break;case"UPD":i({type:"category/fetch_getBigCategoryItem",payload:{id:l.id}}),a.setState({customizeMenusAddOrUpd:!1,customizeMenusAddOrUpdModalVisible:!0});break;case"DEL":i({type:"category/fetch_delBigCategoryItem",payload:{ids:l.id}});break;default:break}}}))}})},a.handelCustomizeMenusAddOrUpd=function(){var e=a.state,t=e.customizeMenusAddOrUpd,n=e.node,r=a.props,l=r.form,i=l.validateFields,o=l.resetFields,s=r.dispatch;i(function(e,r){e?console.log(e):t?s({type:"category/fetch_addBigCategoryItem",payload:r,callback:function(e){0===e.status&&a.setState({customizeMenusAddOrUpdModalVisible:!1},function(){o()})}}):(r.id=n.id,s({type:"category/fetch_updBigCategoryItem",payload:r,callback:function(e){0===e.status&&a.setState({customizeMenusAddOrUpdModalVisible:!1},function(){o()})}}))})},a.customizeMenusAddOrUpdModal=function(){var e=a.state,t=e.customizeMenusAddOrUpdModalVisible,n=e.customizeMenusAddOrUpd,r=a.props,l=r.form.getFieldDecorator,i=r.category.bigCategory_item;return N.a.createElement(b["a"],{centered:!0,title:n?"\u65b0\u589e\u6848\u5377\u5927\u7c7b":"\u4fee\u6539\u6848\u5377\u5927\u7c7b",visible:t,onCancel:function(){return a.setState({customizeMenusAddOrUpdModalVisible:!1})},footer:[N.a.createElement(k["a"],{key:"submit",type:"primary",onClick:a.handelCustomizeMenusAddOrUpd,style:{marginRight:15}},"\u786e\u5b9a"),N.a.createElement(k["a"],{key:"back",onClick:function(){return a.setState({customizeMenusAddOrUpdModalVisible:!1})}},"\u53d6\u6d88")]},N.a.createElement(z["a"],null,N.a.createElement(z["a"].Item,E()({},le,{label:"\u6848\u5377\u5927\u7c7b\u540d\u79f0"}),l("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6848\u5377\u5927\u7c7b\u540d\u79f0"},{validator:H["x"]}],initialValue:n?void 0:i&&i.name||void 0})(N.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u6848\u5377\u5927\u7c7b\u540d\u79f0"}))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u7b80\u79f0"}),l("abbre",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7b80\u79f0"},{pattern:H["b"],message:"\u53ea\u80fd\u8f93\u5165\u7531\u6570\u7ec4\u6216\u5b57\u6bcd\u7ec4\u6210\u7684\u7b80\u79f0"}],initialValue:n?void 0:i&&i.abbre||void 0})(N.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u7b80\u79f0"}))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u6392\u5e8f"}),l("num",{getValueFromEvent:function(e){return e.target.value.replace(/\D/g,"")},initialValue:n?void 0:i&&i.num||void 0})(N.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u6392\u5e8f\u7f16\u53f7"}))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u63cf\u8ff0"}),l("desc",{initialValue:n?void 0:i&&i.desc||void 0})(N.a.createElement(ne,{rows:4,style:{resize:"none"},placeholder:"\u8bf7\u63cf\u8ff0"})))))},a.handleTreeRightClick=function(e){var t=e.event,n=e.node,r=document.body.clientHeight,l=t.pageY;r-l<115&&(l-=200-(r-l)),a.setState({page:{X:t.pageX,Y:l},node:n.props.dataRef,customizeMenusVisible:!0}),n.props={selected:!0}},a.handleTreeClick=function(e,t){var n=a.props.dispatch;console.log(e),e.length>=1&&(n({type:"category/fetch_getBigCategoryItem",payload:{id:e.join(",")},callback:function(e){a.setState({node:e.value,pageParams:e.value})}}),n({type:"category/fetch_getSmallCategoryList",payload:h()({},H["l"],{id:e.join(",")})}))},a.handelSmallAddOrUpd=function(){var e=a.state,t=e.smallAddOrUpd,n=e.node,r=e.updSmallId,l=e.unitId,i=e.workType,o=a.props,s=o.form,d=s.validateFields,c=s.resetFields,u=o.dispatch;d(function(e,o){e||(console.log(o),t?(o.bigCategoryId=n.id,o.unitId=l,u({type:"category/fetch_addSmallCategoryItem",payload:o,callback:function(e){0===e.status&&(a.onRef.setState({start:1}),a.setState({smallAddOrUpdModalVisible:!1,pageParams:{id:o.bigCategoryId}},function(){c()}))}})):("URGENT"===i&&(o.unitId=l),o.id=r,u({type:"category/fetch_updSmallCategoryItem",payload:o,callback:function(e){0===e.status&&(a.onRef.setState({start:1}),a.setState({smallAddOrUpdModalVisible:!1,pageParams:{id:o.bigCategoryId}},function(){c()}))}})))})},a.handelWorkTypeOnChange=function(e){var t=a.props.dispatch;"URGENT"===e.target.value&&t({type:"global/fetch_get_tree"}),a.setState({workType:e.target.value})},a.handleTimeTypeOnChange=function(e){var t=null;switch(e.target.value){case"DAY":t="\u5929";break;case"HOUR":t="\u5c0f\u65f6";break;default:break}a.setState({timeType:t})},a.handleTimeTypeText=function(e){switch(e){case"DAY":return"\u5929";case"HOUR":return"\u5c0f\u65f6";default:break}},a.smallAddOrUpdModal=function(){var e=a.state,t=e.smallAddOrUpd,n=e.smallAddOrUpdModalVisible,r=e.timeType,l=e.workType,i=e.node,o=a.props,s=o.form.getFieldDecorator,d=o.category.smallCategory_item;o.global.tree;return N.a.createElement(b["a"],{title:t?"\u65b0\u589e\u6848\u5377\u5c0f\u7c7b":"\u4fee\u6539\u6848\u5377\u5c0f\u7c7b",visible:n,centered:!0,onCancel:function(){return a.setState({smallAddOrUpdModalVisible:!1,unitId:[]})},footer:[N.a.createElement(k["a"],{key:"submit",type:"primary",onClick:a.handelSmallAddOrUpd,style:{marginRight:15}},"\u786e\u5b9a"),N.a.createElement(k["a"],{key:"back",onClick:function(){return a.setState({smallAddOrUpdModalVisible:!1,unitId:[]})}},"\u53d6\u6d88")]},N.a.createElement(z["a"],null,N.a.createElement(z["a"].Item,E()({},le,{label:"\u7c7b\u522b\u5927\u7c7b"}),s("bigCategoryId",{initialValue:t?i&&i.id:d&&d.bigCategory&&d.bigCategory.id||void 0})(N.a.createElement(D["a"],{style:{display:"none"},disabled:!0})),N.a.createElement("span",null,t?i&&i.name:d&&d.bigCategory&&d.bigCategory.name)),N.a.createElement(z["a"].Item,E()({},le,{label:"\u6848\u5377\u5c0f\u7c7b\u540d\u79f0"}),s("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6848\u5377\u5c0f\u7c7b\u540d\u79f0"},{validator:H["x"]}],initialValue:t?void 0:d&&d.name||void 0})(N.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u6848\u5377\u5c0f\u7c7b\u540d\u79f0"}))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u7b80\u79f0"}),s("abbre",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7b80\u79f0"},{pattern:H["b"],message:"\u53ea\u80fd\u8f93\u5165\u7531\u6570\u7ec4\u6216\u5b57\u6bcd\u7ec4\u6210\u7684\u7b80\u79f0"}],initialValue:t?void 0:d&&d.abbre||void 0})(N.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u7b80\u79f0"}))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u7d27\u6025\u7a0b\u5ea6"}),s("workType",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7d27\u6025\u7a0b\u5ea6"}],initialValue:t?void 0:d&&d.workType||void 0})(N.a.createElement(y["a"].Group,{onChange:a.handelWorkTypeOnChange},N.a.createElement(y["a"],{value:"ORDINARY"},"\u65e5\u5e38"),N.a.createElement(y["a"],{value:"URGENT"},"\u7d27\u6025")))),"URGENT"===l?N.a.createElement(z["a"].Item,E()({},le,{label:"\u804c\u80fd\u90e8\u95e8"}),s("unitId",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u804c\u80fd\u90e8\u95e8"}],initialValue:t?void 0:d&&d.unit&&d.unit.name||void 0})(N.a.createElement(ee["a"],{onChange:function(e){return a.setState({unitId:e})},placeholder:"\u8bf7\u9009\u62e9\u804c\u80fd\u90e8\u95e8"}))):"",N.a.createElement(z["a"].Item,E()({},le,{label:"\u529e\u7406\u65f6\u957f"}),s("timeType",{rules:[{required:!0,message:"\u8bf7\u9009\u529e\u7406\u65f6\u957f"}],initialValue:t?void 0:d&&d.timeType||void 0})(N.a.createElement(y["a"].Group,{onChange:a.handleTimeTypeOnChange},N.a.createElement(y["a"],{value:"DAY",defaultChecked:!0},"\u5929"),N.a.createElement(y["a"],{value:"HOUR"},"\u5c0f\u65f6")))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u8f93\u5165\u65f6\u957f"}),s("time",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8f93\u5165\u65f6\u957f"}],initialValue:t?void 0:d&&d.time||void 0,getValueFromEvent:function(e){return e.target.value.replace(/\D/g,"")}})(N.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u65f6\u957f",addonAfter:r}))),N.a.createElement(z["a"].Item,E()({},le,{label:"\u63cf\u8ff0"}),s("desc",{initialValue:t?void 0:d&&d.desc||void 0})(N.a.createElement(ne,{rows:4,style:{resize:"none"},placeholder:"\u8bf7\u63cf\u8ff0"})))))},a.handleSmallListUpdButton=function(e){var t=a.props.dispatch;a.setState({smallAddOrUpdModalVisible:!0,smallAddOrUpd:!1,updSmallId:e}),t({type:"category/fetch_getSmallCategoryItem",payload:{id:e},callback:function(e){0===e.status&&("URGENT"===e.value.workType?a.setState({unitId:e.value.unit.id&&e.value.unit.id,workType:e.value.workType,timeType:a.handleTimeTypeText(e.value.timeType)}):a.setState({workType:e.value.workType,timeType:a.handleTimeTypeText(e.value.timeType)}))}})},a.setOnRef=function(e){a.onRef=e},a.handleClickReset=function(){a.onRef.addClick()},a}return V()(t,e),S()(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",function(){e.setState({customizeMenusVisible:!1})});var t=this.props.dispatch;t({type:"category/fetch_getBigCategoryList"})}},{key:"render",value:function(){var e=this,t=this.props.category,a=t.bigCategory_list,n=t.smallCategory_list,r=this.state,l=r.customizeMenusVisible,i=r.node,o=r.pageParams,s=[{title:"\u6848\u5377\u5c0f\u7c7b",dataIndex:"name",key:"name",width:110,render:function(e){return N.a.createElement(te["a"],{lines:1},e)}},{title:"\u804c\u80fd\u90e8\u95e8",dataIndex:"unitName",key:"unitName",width:120,render:function(e){return N.a.createElement(te["a"],{lines:1},e[0])}},{title:"\u7d27\u6025\u7a0b\u5ea6",dataIndex:"workType",key:"workType",width:120,render:function(e){return N.a.createElement(te["a"],{lines:1},N.a.createElement("span",{style:Object(H["t"])(e)},Object(H["u"])(e)))}},{title:"\u521b\u5efa\u4eba",dataIndex:"creator",key:"creator",width:110,render:function(e){return N.a.createElement(te["a"],{lines:1},e)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",width:170,render:function(e){return N.a.createElement(te["a"],{lines:1},e)}},{title:"\u64cd\u4f5c",dataIndex:"id",key:"id",width:100,render:function(t,a){return N.a.createElement(k["a"],{type:"primary",onClick:function(){return e.handleSmallListUpdButton(t)}},"\u4fee\u6539")}}];return N.a.createElement(L["Fragment"],null,N.a.createElement(u["a"],{style:{marginTop:10}},N.a.createElement(p["a"],{span:4,className:$.a.TreeMenuLeft},N.a.createElement(x["a"],{showIcon:!0,switcherIcon:N.a.createElement(g["a"],{type:"dd"}),onRightClick:this.handleTreeRightClick,onSelect:this.handleTreeClick,style:{height:"95%"}},this.renderTreeNodes(a)),N.a.createElement(k["a"],{size:"large",className:$.a.TreeMenuButton,onClick:function(){return e.setState({customizeMenusAddOrUpdModalVisible:!0,customizeMenusAddOrUpd:!0})}},"\u65b0\u5efa\u76ee\u5f55"),l&&this.customizeMenus(),this.state.customizeMenusAddOrUpdModalVisible&&this.customizeMenusAddOrUpdModal(),this.state.smallAddOrUpdModalVisible&&this.smallAddOrUpdModal()),N.a.createElement("div",{style:{backgroundColor:"#fff"}},N.a.createElement(p["a"],{span:18,style:{width:"81.166%",minHeight:"91vh",backgroundColor:"#fff",borderRadius:4},className:$.a.menuTableRight},N.a.createElement(m["a"],{spinning:this.props.cateLoading},N.a.createElement(Z,{columns:s,dataSource:n,type:"category/fetch_getSmallCategoryList",delButton:"category/fetch_delSmallCategoryItem",fatherBigListItem:i&&i,smallPaginationParams:o&&o,onRef:this.setOnRef}))))))}}]),t}(L["PureComponent"]),d=c))||d)||d);t["default"]=ie}}]);